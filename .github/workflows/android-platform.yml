# This workflow builds the Android application using Flutter.

name: Android Build (Flutter)

on:
  push:
    branches: [ master ] # Trigger on push to the master branch
  pull_request:
    branches: [ master ] # Trigger on pull requests to the master branch

jobs:
  build:
    # Run on the latest version of Windows
    runs-on: windows-latest

    steps:
    # Checkout the code from the repository
    - name: Checkout code
      uses: actions/checkout@v4

    # Set up the Flutter environment
    # Using channel and architecture for more explicit Flutter version setup
    - name: Set up Flutter
      uses: subosito/flutter-action@v2
      with:
        channel: 'stable'
        architecture: x64

    # Get Flutter dependencies
    # This command fetches all the packages required by the Flutter project
    - name: Get Flutter dependencies
      run: flutter pub get

    # Build the Android debug APK using Flutter
    # This command builds the APK for the Android platform
    - name: Build debug APK
      run: flutter build apk --debug

    # Upload the generated APK as a workflow artifact
    # This makes the APK available for download from the GitHub Actions run page
    # The path reflects the standard output location for 'flutter build apk --debug'
    - name: Upload debug APK artifact
      uses: actions/upload-artifact@v4
      with:
        name: pica-comic-debug-apk # Name of the artifact
        path: build/app/outputs/flutter-apk/app-debug.apk # Standard path for Flutter debug APK
        # Double-check the actual path after a successful local build if this path is incorrect.
